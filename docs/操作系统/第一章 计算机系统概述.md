---
dg-publish: true
dg-home: true
---

![[Pasted image 20230822164311.png]]
####  操作系统与用户通信的接口包括哪些？
####  多道程序设计的基本特征有哪些？
#### 库函数与系统调用的区别
库函数是高级语言提供的方便用户使用的已经封装好的与系统调用相对应的函数，位于用户层，计算机可以在用户态时直接调用库函数，位于系统调用的上层
系统调用是操作系统向上提供的广义指令接口，需要通过用户程序间接进行系统调用，且进行系统调用时，操作系统状态要陷入内核态

补充：
①许多库函数都需要用系统调用实现功能，未使用库函数的执行效率通常要比系统调用的高

## 1.3 操作系统运行环境相关总结
1. 程序的运行时间通过操作系统使用时间片轮转调度算法控制，不需要用户控制
2. 批处理的特点：提高系统利用率和吞吐量，但缺少交互性
3. I/O通道是一种特殊的处理器，具有执行I/O指令的能力，通过执行通道程序控制I/O操作
4. 系统调用需要引发trap指令，程序进行系统调用是发生在用户态的，但是执行系统调用的过程是发生在内核态的，程序设计无法形成屏蔽中断的指令
5. 进程调度算法是由操作系统实现的，不需要硬件支持，而地址映射需要寄存器和地址加法器的支持，时钟管理需要硬件计数器的支持
6. 中断程序本身可能是用户程序，但进入中断的处理程序一定是OS程序
7. 通过硬件中断机制完成用户态到核心态的切换
8. 大多数操作系统内核包括四个方面内容：时钟管理、中断机制、原语和系统调用和程序控制的数据结构和处理，系统调用类的指令也称为广义指令
9. 访管指令仅在用户态中使用
10. 通过汇编语言可以实现的操作基本都是在用户态下执行的
11. 缺页处理、时钟中断、进程调度在内核态执行，而命令解释程序术语命令接口，在用户态运行
12. 外部中断发生在用户态，但在内核态完成中断过程，PC值由中断隐指令保存，操作系统保存通用寄存器的内容
13. 子程序调用需要使用PC保存程序断点，还要保存PSW的内容
14. trap、压栈、跳转指令都可以在用户态运行
15. 只要是CPU指令执行内部发生了故障都是内部中断即异常，如非法操作码、地址越界、算术溢出、虚存系统的缺页以及专门的陷入指令引起的事件
16. 时钟中断主要负责处理和时间有关的信息及决定是否指令调度程序，包括系统时间、进程时间片、延时、使用CPU的时间、各种定时器
17. 中断服务程序会保存中断屏蔽字、各个通用寄存器的值、并提供与中断信号相对应的系统服务
18. 常见的特权指令：I/O相关的指令、访问程序状态的指令、存取特殊寄存器的指令

![[Pasted image 20230826141217.png]]

![[Pasted image 20230826152246.png]]


## 总结
1. 分层次结构依赖关系差：因为各个层次的服务、接口固定。假如只是在最外层调用最内层的服务，那么就需要通过各层之间以递归的方式调用服务，时间开销大，依赖性较差，它们之间的依赖关系只是相邻层的单向依赖关系
2. 微内核性能较差：因为微内核只保留了最接近硬件部分的功能，如低级I/O，进程间通信机制，低级进程管理和调度、陷入等。而进程管理、存储管理、设备管理的功能是在用户空间，所以需要频繁地切换CPU状态，这需要很长的时间开销
3. 大内核的缺点：大内核占用内存空间大、可扩展性差且不方便移植、可靠性低
4. 微内核相比大内核更稳定：因为微内核提供的服务比大内核更少，更少的服务会更稳定
5. 电脑的开机过程是这样的：boot→JMP→BIOS中断向量表→POST→硬盘引导扇区→MBR→硬盘活动分区→PBR→启动管理器→BIOS
 - 启动计算机后，CPU被激活，激活的CPU读取ROM中的boot程序，CS:IP指向FFFF0H
 - IR读取FFFF0H，执行JMP指令，跳转到BIOS
 - 登记BIOS中断程序入口地址，BIOS在内存中最开始的空间创建中断向量表和响应服务程序，以便后续POST过程用到中短短调用功能
 - 进行通电自检POST，检测硬件是否有故障
 - 通电自检POST完成后，若无故障，进行操作系统引导，首先BIOS读取Boot Sequence，将控制权交给启动顺序排在第一位的存储设备（硬盘驱动器）
 - CPU将硬盘引导扇区的内容加载到内存
 - 加载主引导记录MBR，告诉CPU去硬盘的哪个分区找操作系统
 - 扫描硬盘分区表，加载硬盘活动分区，将CPU控制权交给活动分区
 - 加载分区引导记录PBR，读取活动分区的第一个扇区，寻找激活分区根目录下用于引导操作系统的程序——启动管理器
 - 加载启动管理器
 - 加载操作系统

1. 一个时钟周期，CPU只能完成一个操作，称为微操作
2. 堆栈指针SP:保存有关输入参数、局部变量以及那些没有保存在寄存器中的值
3. 程序状态字寄存器：条件码位、CPU优先级、模式以及其他各种条件控制位
4. 与进程有关的系统调用包括：进程创建、进程终止、申请更多内存、释放不再需要的内存、等待一个子进程结束、用另一个程序覆盖该程序
5. 